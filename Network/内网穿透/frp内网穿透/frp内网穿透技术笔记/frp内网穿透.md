# 内网穿透

## 一、frp内网穿透

目的：本文为了电脑之间内网穿透，使两台电脑之间可以远程访问。

试着想想在哪里到可以连接到自己的电脑，多是一件美事。

从学校的电脑连接自己宿舍的电脑就可以不用天天带电脑跑来跑去了。

本文是已经成功内网穿透技术实现远程控制电脑，可以放心食用

只实现了两台电脑之间的远程控制，还没有尝试ipad和手机连接电脑。



#### Frp介绍

frp 是一个开源、简洁易用、高性能的内网穿透和反向代理软件，支持 tcp, udp, http, https等协议。frp 项目官网是 https://github.com/fatedier/frp，

#### frp工作原理

服务端运行，监听一个主端口，等待客户端的连接；
客户端连接到服务端的主端口，同时告诉服务端要监听的端口和转发类型；
服务端fork新的进程监听客户端指定的端口；
外网用户连接到客户端指定的端口，服务端通过和客户端的连接将数据转发到客户端；
客户端进程再将数据转发到本地服务，从而实现内网对外暴露服务的能力。



### 1.下载frp服务端和客户端对应的文件。

网上找的都没什么用，还很乱，要的可以找我，因为一个人弄的话就算看视频可能也要几天时间。因为总会出现一些错误。

![](图片\1.jpg)

#### 服务端的frp文件：

frps

这个是放在云服务器上的，可以放在linux服务器或者window的服务器。

![](图片\2.jpg)



#### 客户端的frp文件：

frpc

这个是放在个人电脑上，修改配置文件就可以然后运行可执行文件就可以让别的电脑远程连接。

![](C:\Users\T001\Desktop\图片\3.jpg)

### 2.配置文件

配置文件需要修改端口和密码。才能根据自己的去连。

#### frps配置文件：frps.ini

需要配置的端口：

- frp端口，给frp客户端连接的端口。
- frp控制网页的端口

```ini
[common]
bind_addr = 0.0.0.0

#服务端运行端口，可以自定义1-65535之间即可

bind_port = 8085	
# =========================================================================
#dashboard WEB控制台登录用户名，可以自定义

dashboard_user = admin	

#dashboard WEB控制台登录密码

dashboard_pwd = 123456

#dashboard WEB控制台端口，可以自定义1-65535之间即可，启动后通过浏览器访问如http://ip:24567

dashboard_port = 8084

#设置客户端token，对应客户端的token配置,作用类似密码验证，可以自定义

token = 123456789
```



#### frpc的配置文件：frpc.ini

需要配置的端口：

- 客户端连接服务端的端口
- 本台电脑提供给外界连接的端口
  - 这个端口电脑是默认3389，我们设置的是3389映射端口，把3389映射到这个端口，别的电脑的访问ip就是:      12.123.24.152:2000     是我们的服务器公网ip12.123.24.152   2000就是我们现在设置的端口号。
- 还可以有mysql的（本文没写）
- 有网站内网穿透（本文没写）



```ini
[common]

# 配置服务器IP地址

server_addr = 12.123.24.152

#配置服务端监听的端口，与服务端的bind_port端口保持一致

server_port = 8085

#服务端配置token，将服务端配置的token复制到此处

token = 123456789

pool_count = 5

#这里是配置端口范围转发

[services]

#类型为tcp

type = tcp

#本地ip地址通常为127.0.0.1

local_ip = 127.0.0.1

#本机的远程端口,默认为3389

local_port = 3389

#映射到服务端的端口范围(公网服务器可用的端口,1-66535)
remote_port =2000
```

别人的访问方式就是：server_addr：remote_port就可以连接。



现在大家到配置好了吧。不知道你们有没有大概了解

我觉得学一门技术，不只是就会用，也要懂一些传输原理。可以去不去了解底层原理，如果感兴趣就可以去了解一下。

我做个图：

![](图片\4.jpg)

- 看到没有frp技术分为frps服务端技术和frpc客户端技术。
- frp技术连接云服务器和个人电脑
- 别的电脑连接的原理就是先连接云服务器：12.123.14.145
- 在服务器上找到：2000端口，这个端口要frp技术处理过的，我们就可以连接了。

注意 上图的frps技术要与frpc技术换个位置

### 3.实现操作：

#### 服务器端：

把frps文件压缩包解压并放在自己的服务器上（我是直接用window的服务器，如果你们是linux也是一样，但是如果单单用linux命令行就比较麻烦了，要了解linux语法，我在文章末尾给写一段代码，演示用linux命令行操作）

点击frps.ini去配置文件信息。

注意bind_port绑定端口就好了。

**注意：必须要去自己云服务器的控制台防火墙和安全组开放对应端口，不然连接不了。**

这个不懂的话可以来问我或者百度。



#### 客户端：

在个人电脑（需要被控制的电脑上），解压frpc文件，并修改frpc.ini文件，注意绑定服务器frps的端口要跟frps.ini一样就好了。

然后在这上面写自己的映射远程连接端口3389的端口就好咯。

**注意：这些端口也要我服务器控制台的防火墙上安全组开放对应端口。**



这样就完成了



这样就可以去尝试连接远程桌面了。





## 可能会遇到的问题：

这些都是我遇到的坑：

### 一、window10系统是家庭版的，没有那些远程连接

![](图片\6.jpg)

你只需要打开自己的高级系统设置点击远程就可以看到自己是否有这个功能。

如果没有你就连接不了。

![](图片\7.jpg)

像这种旗舰版，专业版，专业工作站版才可以用。



如果自己是家庭版的怎么办？？

我帮你解决

下载window一键切换系统，我们选择专业工作站版。这个是最贴近旗舰版的系统，有很多功能。系统切换后就可以用了，然后有空再去激活就好了。

注意要去打开一下自己的远程连接。





## linux命令行解压frps文件

我现在没有linux的服务器，就纯打字了，我觉得我打的没问题可以试一下，如果有问题在问我或者网上吧

进入linux命令行后

```shell
cd /root/home    # 进入某个文件夹，我选择home这个目录 
mkdir frps 		# 创建文件夹
然后把压缩包拖到这个文件夹中，建议用linux可视化，如果没有可视化就用ftp传递文件进来
tar xf frps     # 解压frps文件夹
如果要修改配置文件的话
vim frps.ini
建议在外面配置好配置文件在传进来
然后运行frps.exe就好了，这个用命令行我也不会，百度吧，建议就用linux可视化桌面，点一下就好了。这样多方便
```

